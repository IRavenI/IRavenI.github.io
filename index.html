<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Интерактивная карта земель Эггрегора</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        
        .container {
            position: relative;
            width: 100%;
            height: 100vh;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .map-label {
            font-family: 'Merriweather', serif;
            font-size: 16px;
            color: #3a2a1e;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .continent-label {
            font-family: Georgia, serif;
            font-size: 28px;
            color: white;
            text-transform: uppercase;
            letter-spacing: 2px;
            background: none !important;
            border: none !important;
            font-weight: 700;
            -webkit-text-stroke: 1px black;
            text-shadow: 
                1px 1px 0 #000,
                -1px -1px 0 #000,
                1px -1px 0 #000,
                -1px 1px 0 #000;
        }

        .continent-label div {
            background: none;
            padding: 5px 10px;
        }

        .location-popup {
            font-family: 'Merriweather', serif;
            text-align: center;
        }

        .location-popup h3 {
            margin: 0 0 10px 0;
            color: #3a2a1e;
        }

        .location-popup p {
            margin: 5px 0;
        }

        .controls {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* Стили для кастомного маркера */
        .custom-marker {
            background: none;
            border: none;
        }

        .custom-marker i {
            display: block;
            width: 24px;
            height: 24px;
            background-color: white;
            border: 2px solid #666;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        /* Стили для отображения координат */
        .coordinates-display {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 5px;
            font-family: 'Merriweather', serif;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="map"></div>
        <div class="controls">
            <label>
                <input type="checkbox" id="showLabels" checked> 
                Показать названия
            </label>
        </div>
        <div id="coordinates" class="coordinates-display">
            Координаты: [0, 0]
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Инициализация карты
        const map = L.map('map', {
            crs: L.CRS.Simple,
            minZoom: -2,
            maxZoom: 2
        });

        // Определение размеров изображения и границ
        const imageUrl = 'Eggraegor.png';
        const bounds = [[0, 0], [1000, 1000]];
        const image = L.imageOverlay(imageUrl, bounds).addTo(map);

        // Центрирование карты
        map.fitBounds(bounds);

        // Определение локаций с типами
        const locations = [
            { name: "Норда", coordinates: [950, 534], type: "continent", description: "Северные земли Эггрегора, мистические и холодные" },
            { name: "Уэстиз", coordinates: [550, 200], type: "continent", description: "Западные территории, владения Империи Киматар" },
            { name: "Иста", coordinates: [600, 700], type: "continent", description: "Восточные земли рядом с Барьером" },
            { name: "Сауз", coordinates: [240, 468], type: "continent", description: "Южные территории, заполненные пустыней" },
            { name: "Ярнак", coordinates: [210, 705], type: "continent", description: "Тропические архипелаги" },
            { name: "Вирналь", coordinates: [245, 920], type: "continent", description: "Таинственный остров фей" }
        ];

        // Создание кастомных иконок
        const cityIcon = L.divIcon({
            className: 'custom-marker',
            html: '<i></i>',
            iconSize: [24, 24],
            iconAnchor: [12, 12],
            popupAnchor: [0, -12]
        });

        // Создание маркеров и подписей
        const markers = new Map();
        const labels = new Map();

        locations.forEach(location => {
            if (location.type === "city") {
                // Создание маркера только для городов
                const marker = L.marker(location.coordinates, { icon: cityIcon })
                    .bindPopup(`
                        <div class="location-popup">
                            <h3>${location.name}</h3>
                            <p>${location.description}</p>
                        </div>
                    `)
                    .addTo(map);
                
                markers.set(location.name, marker);

                // Создание подписи для города
                const cityLabel = L.divIcon({
                    className: 'map-label',
                    html: `<div>${location.name}</div>`,
                    iconSize: [100, 40],
                    iconAnchor: [50, -10]
                });

                const labelMarker = L.marker(location.coordinates, {
                    icon: cityLabel,
                    interactive: false
                }).addTo(map);
                
                labels.set(location.name, labelMarker);
            } else {
                // Создание подписи для континента
                const continentLabel = L.divIcon({
                    className: 'continent-label',
                    html: `<div>${location.name}</div>`,
                    iconSize: [150, 50],
                    iconAnchor: [75, 25]
                });

                const labelMarker = L.marker(location.coordinates, {
                    icon: continentLabel,
                    interactive: true
                })
                .bindPopup(`
                    <div class="location-popup">
                        <h3>${location.name}</h3>
                        <p>${location.description}</p>
                    </div>
                `)
                .addTo(map);
                
                labels.set(location.name, labelMarker);
            }
        });

        // Функция переключения отображения подписей
        document.getElementById('showLabels').addEventListener('change', function(e) {
            const isChecked = e.target.checked;
            labels.forEach(label => {
                if (isChecked) {
                    label.addTo(map);
                } else {
                    label.remove();
                }
            });
        });

        // Отслеживание координат курсора
        const coordinatesElement = document.getElementById('coordinates');
        
        map.on('mousemove', function(e) {
            const coordinates = e.latlng;
            coordinatesElement.innerHTML = `Координаты: [${Math.round(coordinates.lat)}, ${Math.round(coordinates.lng)}]`;
        });

        map.on('mouseout', function() {
            coordinatesElement.innerHTML = 'Координаты: [0, 0]';
        });

        // Добавляем обработчик клика для удобного копирования координат в консоль
        map.on('click', function(e) {
            const coordinates = e.latlng;
            const roundedCoords = [Math.round(coordinates.lat), Math.round(coordinates.lng)];
            console.log(`Координаты точки: [${roundedCoords[0]}, ${roundedCoords[1]}]`);
        });
    </script>
</body>
</html>